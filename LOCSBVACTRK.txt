%Script to print SYSB Vacant trunks - Frederic Desautels, 2023
SEND SINK;ERASESF CONSOLE;ERASESF TRKQRRES;
QUIT ALL;MAPCI NODISP;MTC;TRKS;CARRIER;
SEND SFDEV;DISP SYSB;SEND PREVIOUS;
QUIT ALL;LISTSF;EDIT CONSOLE;
END;LINE->C;line 1;0->$COUNT;
SEND SFDEV TRKQRRES;
REPEAT (C-3) (DOWN;
0->D;
REPEAT 4 (
(SUBSTR (LINESTR) (17*D) 12)->B;
IF ((SUBSTR B 3 1) ^= ' ') THEN (1->PMLEN;) ELSE (0->PMLEN;)
IF (B^='            ') THEN (
(DECSTRTONUM (SUBSTR B 9 3))->CKT;
(DECSTRTONUM (SUBSTR B 5 3))->PMNO;
TRKQUERY PM (STRTOSYM (SUBSTR B 0 3+PMLEN)) PMNO CKT;
$COUNT+1->$COUNT;
)
D+1->D;
)
)
SEND PREVIOUS;
QUIT;
LISTSF;
EDIT TRKQRRES;
REPEAT $COUNT (
TRUE->VF;
DOWN 'Location';
REPEAT 24 (DOWN;(SUBSTR (LINESTR) 16 6)->CLLI;VF&(CLLI='Vacant')->VF;)
IF (VF) THEN (
SEND PREVIOUS;
PRINT (SUBSTR (LINESTR) 0 12)+' Vacant';
SEND SINK;
)
)
QUIT;
ERASESF TRKQRRES;ERASESF CONSOLE;
ERASE B D CLLI $COUNT CKT PMNO VF PMLEN C;
SEND PREVIOUS;